package org.manoj.ds.sort;
import java.time.Duration;
import java.time.Instant;
import org.apache.log4j.Logger;
public class SelectionSort implements Sort {
    final static Logger logger = Logger.getLogger(SelectionSort.class);
    private SortingMetadata metadata = null;
    @Override
    public <E extends Comparable<E>> void sort(E[] elements) {
        sort(elements, true);
    }
    @Override
    public <E extends Comparable<E>> void sort(E[] elements, boolean ascending) {
        metadata = new SortingMetadata(elements.length);
        Instant start = Instant.now();
        for (int lastUnsortedIndex = elements.length - 1; lastUnsortedIndex > 0; lastUnsortedIndex--) {
            logger.info("lastUnsortedIndex=" + lastUnsortedIndex + ":");
            int selectedElementIndex = 0;
            for (int selectionIndex = 1; selectionIndex <= lastUnsortedIndex; selectionIndex++) {
                if (ascending) {
                    if ((elements[selectedElementIndex].compareTo(elements[selectionIndex])) < 0) {
                        selectedElementIndex = selectionIndex;
                    }
                } else {
                    if ((elements[selectedElementIndex].compareTo(elements[selectionIndex])) > 0) {
                        selectedElementIndex = selectionIndex;
                    }
                }
                metadata.incrementIterationByOne();
            }
            Sort.swap(elements, selectedElementIndex, lastUnsortedIndex);
            metadata.increamentSwapOperationByOne();
            logger.info("\tselectedElementIndex=" + selectedElementIndex + " | selectedElementValue="
                    + elements[selectedElementIndex] + ":");
            Sort.logInfo(logger, elements);
        }
        Instant finish = Instant.now();
        metadata.setTimeTakenToExecute(Duration.between(start, finish).toNanos());
    }
    @Override
    public SortingMetadata getMetadata() {
        return metadata;
    }
}