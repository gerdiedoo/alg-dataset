"use strict";
Array.prototype.mergesort = function(compare) {
    if ("function" != typeof compare) {
        var desc = compare || false;
        compare = function(a, b) {
            return desc ? a < b : a > b;
        }
    }
    var that = this;
    function merge(left, right) {
        var result = [];
        var il = 0, ir = 0;
        var llen = left.length, rlen = right.length;
        while (il < llen && ir < rlen) {
            if (compare(right[ir], left[il])) {
                result.push(left[il]);
                il += 1;
            } else {
                result.push(right[ir]);
                ir += 1;
            }
        }
        if (il < llen) {
            result = result.concat(left.slice(il));
        }
        if (ir < rlen) {
            result = result.concat(right.slice(ir));
        }
        return result;
    }
    function sort(array) {
        var max = array.length;
        if (max <= 1) {
            return array;
        }
        var mid = max >> 1;
        var left = sort(array.slice(0, mid));
        var right = sort(array.slice(mid, max));
        return merge(left, right);
    }
    return sort(this);
}