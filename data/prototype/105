package assignment6;
import java.util.*;
public class MultiStringColl {
    private btNode c;
    private int howmany;
    private int total;
    public MultiStringColl() {
        c = null;
        howmany = 0;
        total = 0;
    }
    public MultiStringColl(int i) {
        c = null;
        howmany = 0;
        total = 0;
    }
    public void copy(MultiStringColl obj) {
        if(!(this.equals(obj))){
            howmany=obj.howmany;
            total = obj.total;
            c = copytree(obj.c);
        }
    }
    public int belongs(String i) {
        btNode p = c;
        while((p!=null)&&(i.compareTo(p.info)!=0)){
            if(i.compareTo(p.info)<0){
                p = p.left;
            }else{
                p = p.right;
            }
        }
        if(p!=null){
            return p.count;
        }else{
            return 0;
        }
    }
    public void insert(String i) {
        btNode pred = null;
        btNode p = c;
        if(p!=null){
            while((p!=null)&&(p.info.compareTo(i)!=0)){
                pred = p;
                if(i.compareTo(p.info)<0){
                    p = p.left;
                }else{
                    p = p.right;
                }
            }
        }
        if(p!=null){
            p.count++;
            total++;
        }
        else if(p==null){
            howmany++;
            total++;
            p = new btNode(i, null, null, 1);
            if(pred!=null){
                if(i.compareTo(pred.info)<0){
                    pred.left=p;
                } else{
                    pred.right=p;
                }
            } else{
                c = p;
            }
        }
    }
	public void omit(String i) {
		if (c == null) return;  
		btNode parent = null;  
		btNode p = c;  
		while (!p.info.equals(i)) { 		 
			parent = p;
			if (p.info.compareTo(i) > 0)
				p = p.left;
			else
				p = p.right;
		}  
		if (p.count > 1) { 		 
			p.count--;
			total--;;
			return;
		}
		if(p.count == 1) {  
			howmany--;
		}
		btNode pbelow = p;  
		if (p.right == null) {  
			pbelow = p.left;  
		} else if (p.left == null) {  
			pbelow = p.right;  
		} else {  
			btNode pbelow2 = p.left;  
			if (pbelow2.right == null) {
				pbelow = pbelow2;
				pbelow.right = p.right;
			} else {
				while (pbelow2.right.right != null) {
					pbelow2 = pbelow2.right;
				}
				pbelow = pbelow2.right;
				pbelow2.right = pbelow.left;
				pbelow.right = p.right;
				pbelow.left = p.left;
			}
		}
		if (parent == null) {
			c = pbelow;  
		} else if (parent.right == p) {
			parent.right = pbelow;  
		} else {
			parent.left = pbelow;  
		}
		if(p.count > 1) {  
			howmany--;
		}
	total--;
	}
    public int get_howmany() {
        return howmany;
    }
    public int get_total(){
        return total;
    }
    public void print() {
        printtree(c);
    }
    public boolean equals(MultiStringColl obj) {
        if(howmany!=obj.howmany){
            return false;
        }
        else{
            btNode[] thisArray = new btNode[howmany];
            btNode[] objThisArray = new btNode[obj.howmany];
            toarray(c, thisArray, 0);
            toarray(obj.c, objThisArray, 0);
            for(int i = 0; i<thisArray.length; i++){
                if((thisArray[i].info.compareTo(objThisArray[i].info)!=0) || (thisArray[i].count!=objThisArray[i].count)){
                    return false;
                }
            }
        }
        return true;
    }
    private static class btNode{
        private String info;
        private btNode left;
        private btNode right;
        private int count;
        public btNode(){
            info = null;
            left = null;
            right = null;
            count = 0;
        }
        public btNode(String i, btNode lt, btNode rt, int ct){
            info = i;
            left = lt;
            right = rt;
            count = ct; 
        }
    }
    private static btNode copytree(btNode t){
        btNode result = null;
        if(t!=null){
            result = new btNode(t.info, copytree(t.left), copytree(t.right), t.count);
        }
        return result;
    }
    private static void printtree(btNode t){
        if(t!=null){
            printtree(t.left);
            System.out.println(t.info + "("+t.count+")");
            printtree(t.right);
        }
    }
    private static int toarray(btNode t, btNode[] a, int i){
        int num_nodes = 0;
        if(t!=null){
            num_nodes = toarray(t.left, a, i);
            a[num_nodes+i] = new btNode(t.info, null, null, t.count);
            num_nodes = num_nodes + 1 + toarray(t.right, a, num_nodes+i+1);
        }
        return num_nodes;
    }
}